<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>[dbo].[search_MainInfo]</title><link rel="stylesheet" href="../../Style/Master.css" type="text/css"></head><body><div class="pageTitle"><div class="dboTitleName"><img src="../../Images/StoredProcedure.gif" alt="Stored Procedures" class="StoredProcedure"> [dbo].[search_MainInfo]</div><div class="breadcrumbs"><a href="../../index.html">(local)\sqlexpress</a> &gt; <a href="../../index.html">FuTai</a> &gt; <a href="../../Programmability/Stored_Procedures/Stored_Procedures.html">Stored Procedures</a> &gt; dbo.search_MainInfo</div><div class="projectDescriptionTitle"></div></div><ul class="QuickLinks"><li><a href="#properties">Properties</a></li> <li><a href="#parameters">Parameters</a></li> <li><a href="#sql">SQL Script</a></li> <li><a href="#uses">Uses</a></li> </ul><div class="sectionTitle"><a name="properties">Properties</a></div><table cellspacing="1" border="0" class="dataTable"><col class="property"><col class="value"><thead><tr><th class="cell0">Property</th><th class="cell1">Value</th></tr></thead><tbody><tr><td class="cell0">ANSI Nulls On</td><td class="cell1"><img src="../../Images/yes.gif" alt="Yes" class="yes"></td></tr><tr><td class="cell2">Quoted Identifier On</td><td class="cell3"><img src="../../Images/yes.gif" alt="Yes" class="yes"></td></tr></tbody></table><div class="sectionTitle"><a name="parameters">Parameters</a></div><table cellspacing="1" border="0" class="dataTable"><col class="Name"><col class="datatype"><col class="Numeric"><thead><tr><th class="cell0">Name</th><th class="cell1">Data Type</th><th class="cell0">Max Length (Bytes)</th></tr></thead><tbody><tr><td class="cell0">@ProductId</td><td class="cell1">char(10)</td><td class="cell0">10</td></tr></tbody></table><div class="sqlScript"><div class="sectionTitle"><a name="sql">SQL Script</a></div><div id="sqlScript"><br><span class="sqlScriptsKeyword">CREATE</span> <span class="sqlScriptsKeyword">PROCEDURE</span> <span class="sqlScriptsNormal">[dbo]</span><span class="sqlScriptsOperator">.</span><span class="sqlScriptsNormal">[search_MainInfo]</span><br><span class="sqlScriptsOperator">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@ProductId</span> <span class="sqlScriptsKeyword">char</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">10</span><span class="sqlScriptsOperator">)</span><br><span class="sqlScriptsOperator">)</span><br><span class="sqlScriptsKeyword">AS</span><br><span class="sqlScriptsKeyword">BEGIN</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsComment">-- SET NOCOUNT ON added to prevent extra result sets from</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsComment">-- interfering with SELECT statements.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SET</span> <span class="sqlScriptsKeyword">NOCOUNT</span> <span class="sqlScriptsKeyword">ON</span><span class="sqlScriptsNormal">;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">DECLARE</span> <span class="sqlScriptsNormal">@ProductType</span> <span class="sqlScriptsKeyword">varchar</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">20</span><span class="sqlScriptsNormal">);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">set</span> <span class="sqlScriptsNormal">@ProductType</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsOperator">NULL</span><span class="sqlScriptsNormal">;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsComment">-- Insert statements for procedure here</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">select</span> <span class="sqlScriptsNormal">@ProductType</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">ProductType</span> <span class="sqlScriptsKeyword">from</span> <span class="sqlScriptsNormal">Product</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">WHERE</span> <span class="sqlScriptsNormal">ProductId</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">@ProductId</span><br><br>&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">if</span> <span class="sqlScriptsNormal">@ProductType</span> <span class="sqlScriptsOperator">IS</span> <span class="sqlScriptsOperator">NULL</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">RETURN</span><span class="sqlScriptsNormal">;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">DECLARE</span> <span class="sqlScriptsNormal">@Sql</span> <span class="sqlScriptsKeyword">varchar</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsFunction">MAX</span><span class="sqlScriptsNormal">);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SET</span> <span class="sqlScriptsNormal">@Sql</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsString">'SELECT * FROM '</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsNormal">@ProductType</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsString">' m'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">+</span> <span class="sqlScriptsString">' INNER JOIN Product p'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">+</span> <span class="sqlScriptsString">' ON m.'</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsNormal">@ProductType</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsString">'Id = p.ProductId'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">+</span> <span class="sqlScriptsString">' WHERE p.ProductId = '''</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsFunction">CAST</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsFunction">Rtrim</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@ProductId</span><span class="sqlScriptsOperator">)</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsKeyword">varchar</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">20</span><span class="sqlScriptsNormal">))</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsString">''''</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">PRINT</span> <span class="sqlScriptsNormal">@Sql</span><span class="sqlScriptsNormal">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">EXEC</span> <span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Sql</span><span class="sqlScriptsNormal">);</span><br><span class="sqlScriptsKeyword">END</span><br><br><br><span class="sqlScriptsNormal">GO</span><br></div></div><div class="sectionTitle"><a name="uses">Uses</a></div><ul class="DependencyList"><li><a href="../../Tables/Product.html">[dbo].[Product]</a></li> <li>dbo</li> </ul><div class="footer">Created 20 &#20061;&#26376; 2009 03:28<br>Copyright &nbsp;2009 - All Rights Reserved</div></body></html>