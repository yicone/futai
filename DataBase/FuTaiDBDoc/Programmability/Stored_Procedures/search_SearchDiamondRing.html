<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>[dbo].[search_SearchDiamondRing]</title><link rel="stylesheet" href="../../Style/Master.css" type="text/css"></head><body><div class="pageTitle"><div class="dboTitleName"><img src="../../Images/StoredProcedure.gif" alt="Stored Procedures" class="StoredProcedure"> [dbo].[search_SearchDiamondRing]</div><div class="breadcrumbs"><a href="../../index.html">(local)\sqlexpress</a> &gt; <a href="../../index.html">FuTai</a> &gt; <a href="../../Programmability/Stored_Procedures/Stored_Procedures.html">Stored Procedures</a> &gt; dbo.search_SearchDiamondRing</div><div class="projectDescriptionTitle"></div></div><ul class="QuickLinks"><li><a href="#properties">Properties</a></li> <li><a href="#parameters">Parameters</a></li> <li><a href="#sql">SQL Script</a></li> <li><a href="#uses">Uses</a></li> </ul><div class="sectionTitle"><a name="properties">Properties</a></div><table cellspacing="1" border="0" class="dataTable"><col class="property"><col class="value"><thead><tr><th class="cell0">Property</th><th class="cell1">Value</th></tr></thead><tbody><tr><td class="cell0">ANSI Nulls On</td><td class="cell1"><img src="../../Images/yes.gif" alt="Yes" class="yes"></td></tr><tr><td class="cell2">Quoted Identifier On</td><td class="cell3"><img src="../../Images/yes.gif" alt="Yes" class="yes"></td></tr></tbody></table><div class="sectionTitle"><a name="parameters">Parameters</a></div><table cellspacing="1" border="0" class="dataTable"><col class="Name"><col class="datatype"><col class="Numeric"><thead><tr><th class="cell0">Name</th><th class="cell1">Data Type</th><th class="cell0">Max Length (Bytes)</th></tr></thead><tbody><tr><td class="cell0">@Price1</td><td class="cell1">decimal(18,0)</td><td class="cell0">9</td></tr><tr><td class="cell2">@Price2</td><td class="cell3">decimal(18,0)</td><td class="cell2">9</td></tr><tr><td class="cell0">@Type1</td><td class="cell1">int</td><td class="cell0">4</td></tr></tbody></table><div class="sqlScript"><div class="sectionTitle"><a name="sql">SQL Script</a></div><div id="sqlScript"><br><br><span class="sqlScriptsKeyword">CREATE</span> <span class="sqlScriptsKeyword">PROCEDURE</span> <span class="sqlScriptsNormal">[dbo]</span><span class="sqlScriptsOperator">.</span><span class="sqlScriptsNormal">[search_SearchDiamondRing]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@Price1</span> <span class="sqlScriptsKeyword">DECIMAL</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsOperator">NULL</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@Price2</span> <span class="sqlScriptsKeyword">DECIMAL</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsOperator">NULL</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@Type1</span> <span class="sqlScriptsKeyword">INT</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsOperator">NULL</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">)</span><br><span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsComment">/* SET NOCOUNT ON */</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">Declare</span> <span class="sqlScriptsNormal">@SQL</span> <span class="sqlScriptsKeyword">varchar</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">1000</span><span class="sqlScriptsOperator">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">Declare</span> <span class="sqlScriptsNormal">@Tcontion</span> <span class="sqlScriptsKeyword">varchar</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">400</span><span class="sqlScriptsOperator">)</span> <br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">Begin</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SET</span> <span class="sqlScriptsNormal">@Type1</span><span class="sqlScriptsOperator">=</span><span class="sqlScriptsFunction">ISNULL</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Type1</span><span class="sqlScriptsNormal">,</span><span class="sqlScriptsNormal">0</span><span class="sqlScriptsNormal">);</span>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">END</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">IF</span> <span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Type1</span><span class="sqlScriptsOperator">=</span><span class="sqlScriptsNormal">0</span><span class="sqlScriptsOperator">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">BEGIN</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SELECT</span> <span class="sqlScriptsNormal">@Tcontion</span><span class="sqlScriptsNormal">=</span><span class="sqlScriptsString">''</span><span class="sqlScriptsNormal">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">END</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">ELSE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">BEGIN</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SELECT</span> <span class="sqlScriptsNormal">@Tcontion</span><span class="sqlScriptsNormal">=</span><span class="sqlScriptsString">' AND Type1='</span><span class="sqlScriptsOperator">+</span> <span class="sqlScriptsFunction">CAST</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Type1</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsKeyword">varchar</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">10</span><span class="sqlScriptsNormal">));</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">END</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">BEGIN</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SET</span> <span class="sqlScriptsNormal">@price1</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsFunction">ISNULL</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Price1</span><span class="sqlScriptsNormal">,</span> <span class="sqlScriptsNormal">0</span><span class="sqlScriptsOperator">)</span> <span class="sqlScriptsNormal">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SET</span> <span class="sqlScriptsNormal">@Price2</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsFunction">ISNULL</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Price2</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">(</span> <span class="sqlScriptsKeyword">SELECT</span>&nbsp;&nbsp;&nbsp;<span class="sqlScriptsFunction">MAX</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">p.Price</span><span class="sqlScriptsOperator">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">FROM</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">dbo.DiamondRing</span> <span class="sqlScriptsNormal">rb</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">INNER</span> <span class="sqlScriptsOperator">JOIN</span> <span class="sqlScriptsNormal">dbo.Product</span> <span class="sqlScriptsNormal">p</span> <span class="sqlScriptsKeyword">ON</span> <span class="sqlScriptsNormal">rb.DiamondRingId</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">p.ProductId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">))</span> <span class="sqlScriptsNormal">;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SELECT</span> <span class="sqlScriptsNormal">@SQL</span><span class="sqlScriptsNormal">=</span><span class="sqlScriptsString">'SELECT&nbsp;&nbsp;*<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;&nbsp;dbo.DiamondRing rb<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INNER JOIN dbo.Product p ON rb.DiamondRingId = p.ProductId<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;&nbsp;p.Price BETWEEN '</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsFunction">CAST</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Price1</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsKeyword">varchar</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">20</span><span class="sqlScriptsNormal">))</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsString">'&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;'</span><span class="sqlScriptsOperator">+</span> <span class="sqlScriptsFunction">CAST</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Price2</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsKeyword">varchar</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">20</span><span class="sqlScriptsNormal">))</span> <span class="sqlScriptsOperator">+</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@Tcontion</span> <span class="sqlScriptsOperator">+</span> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsComment">--AND Type2 = @Type2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsString">'ORDER BY p.CreateDate,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.Price'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">EXEC</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@SQL</span><span class="sqlScriptsNormal">);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">END</span><br><br><br><br><br><span class="sqlScriptsNormal">GO</span><br></div></div><div class="sectionTitle"><a name="uses">Uses</a></div><ul class="DependencyList"><li><a href="../../Tables/DiamondRing.html">[dbo].[DiamondRing]</a></li> <li><a href="../../Tables/Product.html">[dbo].[Product]</a></li> <li>dbo</li> </ul><div class="footer">Created 20 &#20061;&#26376; 2009 03:28<br>Copyright &nbsp;2009 - All Rights Reserved</div></body></html>