<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>[dbo].[search_SearchPairRing]</title><link rel="stylesheet" href="../../Style/Master.css" type="text/css"></head><body><div class="pageTitle"><div class="dboTitleName"><img src="../../Images/StoredProcedure.gif" alt="Stored Procedures" class="StoredProcedure"> [dbo].[search_SearchPairRing]</div><div class="breadcrumbs"><a href="../../index.html">(local)\sqlexpress</a> &gt; <a href="../../index.html">FuTai</a> &gt; <a href="../../Programmability/Stored_Procedures/Stored_Procedures.html">Stored Procedures</a> &gt; dbo.search_SearchPairRing</div><div class="projectDescriptionTitle"></div></div><ul class="QuickLinks"><li><a href="#properties">Properties</a></li> <li><a href="#parameters">Parameters</a></li> <li><a href="#sql">SQL Script</a></li> <li><a href="#uses">Uses</a></li> </ul><div class="sectionTitle"><a name="properties">Properties</a></div><table cellspacing="1" border="0" class="dataTable"><col class="property"><col class="value"><thead><tr><th class="cell0">Property</th><th class="cell1">Value</th></tr></thead><tbody><tr><td class="cell0">ANSI Nulls On</td><td class="cell1"><img src="../../Images/yes.gif" alt="Yes" class="yes"></td></tr><tr><td class="cell2">Quoted Identifier On</td><td class="cell3"><img src="../../Images/yes.gif" alt="Yes" class="yes"></td></tr></tbody></table><div class="sectionTitle"><a name="parameters">Parameters</a></div><table cellspacing="1" border="0" class="dataTable"><col class="Name"><col class="datatype"><col class="Numeric"><thead><tr><th class="cell0">Name</th><th class="cell1">Data Type</th><th class="cell0">Max Length (Bytes)</th></tr></thead><tbody><tr><td class="cell0">@Price1</td><td class="cell1">decimal(18,0)</td><td class="cell0">9</td></tr><tr><td class="cell2">@Price2</td><td class="cell3">decimal(18,0)</td><td class="cell2">9</td></tr><tr><td class="cell0">@Type1</td><td class="cell1">int</td><td class="cell0">4</td></tr></tbody></table><div class="sqlScript"><div class="sectionTitle"><a name="sql">SQL Script</a></div><div id="sqlScript"><span class="sqlScriptsKeyword">CREATE</span> <span class="sqlScriptsKeyword">PROCEDURE</span> <span class="sqlScriptsNormal">[dbo]</span><span class="sqlScriptsOperator">.</span><span class="sqlScriptsNormal">[search_SearchPairRing]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@Price1</span> <span class="sqlScriptsKeyword">DECIMAL</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsOperator">NULL</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@Price2</span> <span class="sqlScriptsKeyword">DECIMAL</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsOperator">NULL</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@Type1</span> <span class="sqlScriptsKeyword">INT</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsOperator">NULL</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">)</span><br><span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsComment">/* SET NOCOUNT ON */</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">BEGIN</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">DECLARE</span> <span class="sqlScriptsNormal">@PairRingExt</span> <span class="sqlScriptsKeyword">TABLE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">PairId</span> <span class="sqlScriptsKeyword">CHAR</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">10</span><span class="sqlScriptsOperator">)</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">PairRingId0</span> <span class="sqlScriptsKeyword">CHAR</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">10</span><span class="sqlScriptsNormal">),</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">PairRingId1</span> <span class="sqlScriptsKeyword">CHAR</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">10</span><span class="sqlScriptsNormal">),</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">Price</span> <span class="sqlScriptsKeyword">MONEY</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">StockNumber0</span> <span class="sqlScriptsKeyword">NCHAR</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">10</span><span class="sqlScriptsOperator">)</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">StockNumber1</span> <span class="sqlScriptsKeyword">NCHAR</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">10</span><span class="sqlScriptsOperator">)</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">Sex0</span> <span class="sqlScriptsKeyword">Bit</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">Sex1</span> <span class="sqlScriptsKeyword">Bit</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">Price0</span> <span class="sqlScriptsKeyword">MONEY</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">Price1</span> <span class="sqlScriptsKeyword">MONEY</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">CreateDate</span> <span class="sqlScriptsKeyword">DATETIME</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SET</span> <span class="sqlScriptsNormal">@price1</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsFunction">ISNULL</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Price1</span><span class="sqlScriptsNormal">,</span> <span class="sqlScriptsNormal">0</span><span class="sqlScriptsOperator">)</span> <span class="sqlScriptsNormal">;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SET</span> <span class="sqlScriptsNormal">@Price2</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsFunction">ISNULL</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Price2</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">(</span> <span class="sqlScriptsKeyword">SELECT</span>&nbsp;&nbsp;&nbsp;<span class="sqlScriptsFunction">MAX</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">p.Price</span><span class="sqlScriptsOperator">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">FROM</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">dbo.PairRing</span> <span class="sqlScriptsNormal">rb</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">INNER</span> <span class="sqlScriptsOperator">JOIN</span> <span class="sqlScriptsNormal">dbo.Product</span> <span class="sqlScriptsNormal">p</span> <span class="sqlScriptsKeyword">ON</span> <span class="sqlScriptsNormal">rb.PairRingId</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">p.ProductId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">))</span> <span class="sqlScriptsNormal">;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SELECT</span>&nbsp;&nbsp;<span class="sqlScriptsNormal">PairRingId</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">PairId</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">Sex</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">INTO</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">#</span><span class="sqlScriptsNormal">temp0</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">FROM</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">dbo.PairRing</span> <span class="sqlScriptsNormal">pr</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">INNER</span> <span class="sqlScriptsOperator">JOIN</span> <span class="sqlScriptsNormal">dbo.Product</span> <span class="sqlScriptsNormal">p</span> <span class="sqlScriptsKeyword">ON</span> <span class="sqlScriptsNormal">pr.PairRingId</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">p.ProductId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">WHERE</span>&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">p.Price</span> <span class="sqlScriptsOperator">BETWEEN</span> <span class="sqlScriptsNormal">@Price1</span> <span class="sqlScriptsOperator">AND</span> <span class="sqlScriptsNormal">@Price2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">AND</span> <span class="sqlScriptsNormal">Type1</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsFunction">ISNULL</span><span class="sqlScriptsOperator">(</span><span class="sqlScriptsNormal">@Type1</span><span class="sqlScriptsNormal">,</span> <span class="sqlScriptsNormal">Type1</span><span class="sqlScriptsOperator">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">ORDER</span> <span class="sqlScriptsKeyword">BY</span> <span class="sqlScriptsNormal">p.CreateDate</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">p.Price</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SELECT</span>&nbsp;&nbsp;<span class="sqlScriptsNormal">PairId</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">(</span> <span class="sqlScriptsKeyword">SELECT</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">PairRingId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">FROM</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">dbo.PairRing</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">WHERE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">PairRing.PairId</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">t.PairId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">AND</span> <span class="sqlScriptsNormal">PairRing.Sex</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">0</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">)</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">PairRingId0</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">(</span> <span class="sqlScriptsKeyword">SELECT</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">PairRingId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">FROM</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">dbo.PairRing</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">WHERE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">PairRing.PairId</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">t.PairId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">AND</span> <span class="sqlScriptsNormal">dbo.PairRing.Sex</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">1</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">)</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">PairRingId1</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">INTO</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">#</span><span class="sqlScriptsNormal">temp1</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">FROM</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">#</span><span class="sqlScriptsNormal">temp0</span> <span class="sqlScriptsNormal">t</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">GROUP</span> <span class="sqlScriptsKeyword">BY</span> <span class="sqlScriptsNormal">PairId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">INSERT</span>&nbsp;&nbsp;<span class="sqlScriptsKeyword">INTO</span> <span class="sqlScriptsNormal">@PairRingExt</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SELECT</span>&nbsp;&nbsp;<span class="sqlScriptsNormal">t.PairId</span> <span class="sqlScriptsNormal">,</span><span class="sqlScriptsNormal">t.PairRingId0</span><span class="sqlScriptsNormal">,</span><span class="sqlScriptsNormal">t.PairRingId1</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">(</span> <span class="sqlScriptsNormal">p0.Price</span> <span class="sqlScriptsOperator">+</span> <span class="sqlScriptsNormal">p1.Price</span> <span class="sqlScriptsOperator">)</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">Price</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">pr0.StockNumber</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">StockNumber0</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">pr1.StockNumber</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">StockNumber1</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">pr0.Sex</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">Sex0</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">pr1.Sex</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">Sex1</span><span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">p0.Price</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">Price0</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">p1.Price</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">Price1</span> <span class="sqlScriptsNormal">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">p0.CreateDate</span> <span class="sqlScriptsKeyword">AS</span> <span class="sqlScriptsNormal">CreateDate</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">FROM</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">#</span><span class="sqlScriptsNormal">temp1</span> <span class="sqlScriptsNormal">t</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">INNER</span> <span class="sqlScriptsOperator">JOIN</span> <span class="sqlScriptsNormal">PairRing</span> <span class="sqlScriptsNormal">pr0</span> <span class="sqlScriptsKeyword">ON</span> <span class="sqlScriptsNormal">t.PairRingId0</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">pr0.PairRingId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">INNER</span> <span class="sqlScriptsOperator">JOIN</span> <span class="sqlScriptsNormal">PairRing</span> <span class="sqlScriptsNormal">pr1</span> <span class="sqlScriptsKeyword">ON</span> <span class="sqlScriptsNormal">t.PairRingId1</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">pr1.PairRingId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">INNER</span> <span class="sqlScriptsOperator">JOIN</span> <span class="sqlScriptsNormal">Product</span> <span class="sqlScriptsNormal">p0</span> <span class="sqlScriptsKeyword">ON</span> <span class="sqlScriptsNormal">t.PairRingId0</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">p0.ProductId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsOperator">INNER</span> <span class="sqlScriptsOperator">JOIN</span> <span class="sqlScriptsNormal">Product</span> <span class="sqlScriptsNormal">p1</span> <span class="sqlScriptsKeyword">ON</span> <span class="sqlScriptsNormal">t.PairRingId1</span> <span class="sqlScriptsOperator">=</span> <span class="sqlScriptsNormal">p1.ProductId</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">SELECT</span>&nbsp;&nbsp;<span class="sqlScriptsOperator">*</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">FROM</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsNormal">@PairRingExt</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sqlScriptsKeyword">END</span><br><br><br><span class="sqlScriptsNormal">GO</span><br></div></div><div class="sectionTitle"><a name="uses">Uses</a></div><ul class="DependencyList"><li><a href="../../Tables/PairRing.html">[dbo].[PairRing]</a></li> <li><a href="../../Tables/Product.html">[dbo].[Product]</a></li> <li>dbo</li> </ul><div class="footer">Created 20 &#20061;&#26376; 2009 03:28<br>Copyright &nbsp;2009 - All Rights Reserved</div></body></html>